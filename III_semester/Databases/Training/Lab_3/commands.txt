Problem 1.

1.
SELECT job, COUNT(empno) AS employees, AVG(sal) FROM emp GROUP BY job; 

2.
SELECT deptno, COUNT(CASE WHEN comm IS NOT NULL THEN 1 END) AS employees FROM emp GROUP BY DEPTNO;

3.
SELECT job, MAX(sal) FROM emp WHERE sal > 1000 GROUP BY job HAVING COUNT(*) > 3;

4.
SELECT LOC, EMP.DEPTNO, JOB, MAX(SAL) - MIN(SAL) AS ROZPIETOSC FROM EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO GROUP BY LOC, EMP.DEPTNO, JOB HAVING MAX(SAL) - MIN(SAL) > 300;

5.
SELECT AVG(SAL), DEPTNO AS BOSS_DEPT_NUM FROM EMP WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE MGR IS NULL) GROUP BY DEPTNO;

6.
SELECT MGR AS EMPNO FROM EMP GROUP BY mgr HAVING COUNT(DISTINCT DEPTNO) > 1;

7.
SELECT ENAME, SAL FROM EMP WHERE (JOB, DEPTNO) IN (SELECT JOB, DEPTNO FROM EMP GROUP BY JOB, DEPTNO HAVING COUNT(*) = 1) ORDER BY SAL DESC;







Problem 2.

1.

